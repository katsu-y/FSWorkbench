# FSWorkbench
### Version 3.4

FSWorkbenchは、コンピュータのハードディスクなどローカルストレージ上のボリュームに含まれるファイルをGUIのリスト形式で表示・操作するアプリケーションです。

ファイルシステム関連の情報を表示する他、コピー,移動,削除など基本的な操作も行えます。

ドライブの割り当てられていないボリュームを参照することも出来ます。

ユーザーインターフェイスはMDI形式でTABを備えており、複数のファイルリストを表示できます。
>**Warning**現在採用されているMDI形式のウィンドウ構成は、次版（Ver.3.5）で廃止されます。[\(※MDIについて\)](#mdi形式について)

通常はユーザーモードで使用できますが、管理者モードで実行した場合すべての機能が利用できます。

**注:** 現状ではFSWorkbenchはオープンソースではありません。

**NOTICE:** FSWorkbench is not open source. You will find here the builds only. 

### Version 3.4.627.0 の更新内容   

- ユーザーモードのファイルリストで、親ディレクトリから降りていけなくてもパスを直接指定すれば参照できるはずのディレクトリを開けない不具合を修正しました。    
  具体的には "C:\Program Files\WindowsApps\" 下のディレクトリです。

- ボリュームセンターのボリューム情報で仮想ディスクを表示した際、「依存ボリュームファイル名」のパスが誤っている不具合を修正しました。同時に項目の内容を整理しました。

- ボリュームナビゲーションペインで、ISOファイルがボリュームとしてアタッチされている時に項目テキストが仮想ディスクの色（青）にならない不具合を修正しました。
  これはボリュームにアクセス可能な場合に限ります。

- 管理者モード時、ファイルリストで拡張子が.vhd;.vhdx;.isoのファイルを選択してメニューの\[操作\]またはコンテキストメニューを開いた時、\[ファイル拡張子別の操作\]に\[仮想ボリュームとして接続する\]が表示される様になりました。

- 管理者モード時、ボリュームナビゲーションペインに仮想ディスクの切り離しコマンドを試験的に追加しました。

- その他、内部の細かい不具合を修正しました。

### Version 3.4.626.0 の更新内容   

**重要な変更**
本バージョンより、サブディレクトリ以下を含めてファイルを検索する場合、リパースポイントを処理しない様に変更しました。
そのため、検索対象内に他のディレクトリをポイントするリパースポイントが含まれていた場合、以下の処理で結果が異なります。    
  - 対象
    - 検索
    - ディレクトリの使用状況
    - 同じファイルを探す
    - 拡張子の列挙
    - サブディレクトリを含む場合の属性変更
    - サブディレクトリを含む場合のACL変更

ファイルの検索でリパースポイントを処理する場合は、今回追加された\[リパースポイントを処理しない\]のチェックを外してください。
このチェックを外した場合は、リパースポイントの内容によっては他の場所に存在するディレクトリやファイルを含む場合があります。
検索開始の場所より上位のディレクトリを自己参照している場合、繰り返し同じ内容が表示されることに留意してください。

>**Note** ファイルのコピー/移動および削除処理は以前のバージョンよりリパースポイントは処理していません。

**その他の変更内容**

- サイドパネルの\[アクセス許可\]ペインを\[セキュリティ\]に変更しました。 ACLの内容とSACL（監査、整合性レベル）の表示をグループで分けて表示する様にしました。

- 同じディレクトリへの（同じウィンドウ内での）ファイルのドロップに対応しました。

- コピー/移動処理時、事前のファイル数確認など前準備に時間がかかる場合ダイアログを表示する様にしました。

- \[同じファイルを探す\]機能で、処理対象のファイルの上限を100,000件に設定しました。

- Windows10の管理者モードでC:ドライブのルートからファイル検索した場合、Windowsの構成（具体的にはサンドボックス機能を有効にしている場合）によってはスタックオーバーフローを起こす不具合に対応しました。本件の対応に合わせデフォルトでリパースポイントの処理を無効にすると共に、サブディレクトリを含む検索処理に階層の上限を設定しました。64bit版の場合最大2048階層、32bit版の場合は1024階層となります。

- ファイルリストのパスにシャドウボリュームを指定できなくなっていた不具合を修正しました。

- その他細かい不具合を修正しました。
  
### Version 3.4.621.2 の更新内容   

- Windows 7のAeroモードで実行した時、タブなど一部が誤った配色で表示される不具合を修正しました。

- メニューハンドルのリークを修正しました。

### Version 3.4.621.0 の更新内容   

- ナビゲーションペインのボタン配置を変更しました。

  \[ファイルリスト\]ボタンのテキストを\[ウィンドウタブ\]に変更し、バーの下端に配置する様に変更しました。

- Windows 7 でクラシックモード時のウィンドウデザイン・配色を改善しました。   
(デザインはモード切り替えに動的に追従しません。Aero/Classicを切り替える際はFSWorkbenchを一旦終了して切り替え後再度立ち上げてください。切り替えでデザインが崩れた場合は再立ち上げしてください)

- 細かい不具合を修正しました。  

### Version 3.4の新機能と更新内容   

- ナビゲーションペインの変更   
  従来タブで切り替えていたナビゲーションペインのページを、ウィンドウ左端に設けた「Outlookバー」状のタブで切り替える様に変更しました。ページはメインメニューからも切り替えできます。
  ※将来削除・変更される可能性があります。   
  ※プレビュー版で存在したディレクトリツリーは一旦保留となり使用できなくなりました。
  
  - ~~ファイルリスト~~（621.0では \[ウィンドウタブ\] に変更されました）   
    新しく追加されました。表示中のファイルリストウィンドウの一覧が表示されます。ウィンドウ タブの様な操作をします。

  - ボリューム   
    従来の「ボリューム」です。NTデバイスネームスペースでのボリューム一覧から表示・選択できます。

  - 場所   
    新しく追加されました。ボリューム、ドライブ、シェルフォルダの一部、ブックマークをグループ化して表示するページです。   
    現在レイアウトはuserfolders.iniに定義されていますが編集した場合の動作は保証されません。

  - ブックマーク   
    従来の「ブックマーク」です。ブックマークされたディレクトリの一覧から表示選択できます。

  - お気に入り   
    新しく追加されました。お気に入りの一覧から表示・選択できます。
    旧バージョンFSDirWalkerが作成したファイルも使用できます。
  
  
- ファイルリストの\[表示の種類\]にタイル表示を追加   

  ファイルリストの\[表示の種類]に\[タイル]と\[サムネイルタイル]を追加しました。   
  現在、デフォルトでタイルにファイル名のみ表示されます。タイル表示時に更新日付とサイズを表示したい場合は、レジストリに以下の値を追加します。   

- お気に入りの追加、整理をサポート   

  ファイルやディレクトリをお気に入りとして登録するための追加、整理機能をサポートしました。   

### MDI形式について   
現在採用されているMDI形式のウィンドウ構成は、次版（Ver.3.5）以降で廃止される予定です。単純なタブ切り替えのみのウィンドウとなります。
MicrosoftがMDI形式を推奨していないこと、MDI子ウィンドウのデザインがWindows10/11に対応していないこと、機能を拡張する際にプログラム的にMDIでは維持が困難になってきたこと（特にWindows 10/11では、Win32アプリケーションはWindows 7と比べてウィンドウサイズ変更・再描画処理が著しく遅くなる）、現代的なユーザーインターフェイスに移行する際に適切ではないことなどが理由です。

### 実行環境

Windows 10,Windows 8.1,Windows 7
(64bit版/32bit版)

### インストール

適切な場所にフォルダを作成し、書庫ファイルの内容を展開してください。<br>
空のフォルダに展開することを強くお勧めします。

### 実行方法
展開した場所から、fsworkbench.exeを実行してください。

### アンインストール

現在アンインストーラは用意されておりませんので、展開したファイルをユーザーご自身で削除してください。

現在はアンインストールしてもレジストリキーがそのままになります。気になる場合はご自身でキーを削除してください。
FSWorkbench自身が使用するレジストリキーは以下の通りです。
 (他にWindowsが他のレジストリパスに記録することがあります)

      HKEY_CURRENT_USER\Software\YamashitaSoftwareWorks\FSWorkbench

### 使用条件

本ソフトウェアは、下記条件を承諾の上であれば自由に無償で使用できます。

- 本ソフトウェアはご利用になる方の責任で使用してください。
  作者及び頒布者は本ソフトウェアの実行によって生じる結果に関して一切の責任を
  負いません。

- 本ソフトウェアを操作した結果データが失われたり、ソフトウェアが表示した内容，
  実行環境の差異，未知の不具合などが原因で損害が生じた場合でも、作者及び頒布者
  は一切の責任を負いません。

- 本ソフトウェアは自由に再頒布できますが、再頒布時は書庫ファイル内のファイル,
  ディレクトリ構成はそのままで変更しないでください。

- ソフトウェアの性質上、コンピュータ上のファイルの削除や属性の変更、コピーに
  よる内容の上書きなど、ファイルに対して不可逆な操作も行えますので十分注意し
  て使用してください。

- 不具合等の連絡は、下記メールアドレスなどよりお願いします。

- 本ソフトウェアの著作権は作者が留保します。

  Copyright (C) 2015-2022 山下 克宏 (YAMASHITA Katsuhiro), Yamashita Software Works
